<!DOCTYPE html>

<html>
<head>
  <title>sam.lua</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>sam.lua</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-1">&#x00a7;</a>
              </div>
              <p><span id="forkongithub"><a href="https://github.com/timm/shortr">Fork me on GitHub</a></span>
<a href="https://github.com/timm/shortr/actions/workflows/tests.yml"><img src="https://github.com/timm/shortr/actions/workflows/tests.yml/badge.svg"></a><br><a 
href="https://zenodo.org/badge/latestdoi/206205826"> <img src="https://zenodo.org/badge/206205826.svg" alt="DOI"></a></p>
<p> <img width=150 align=left src="https://raw.githubusercontent.com/timm/shortr/master/docs/img/cup.png">
<b>Michelangelo:</b><br>
<em>Every <strike>block of stone</strike> program  has a <strike>statue</strike> smaller program inside it and it is the task of the 
<strike>sculptor</strike>designer to discover it.</em>

<p><b>Dieter Rans:</b><br><em>Less, but better.</em></p>
<p>If I really know “it”, then should I  know all “it”s shortcuts; i.e. how
to write “it” succinctly (in fewer lines) and how to make “it” run faster.
Further, I should be able to generalize “it” such that I can quickly
adapt “it” to other purposes.</p>
<p>So, do I understand a multi-objective semi-supervised explanation?
Well, maybe. Here’s all that, most of which is
background stuff that could be used for other learners.  </p>
<p>Once
I build that, I found that decision trees, Naive Bayes classifiers,
and nearest neighbors were all a tiny extension. </p>
<p>Also included here
is literate programming, self-documenting code and support for
test-driven development. </p>
<p>All in around 300 lines of LUA: <br></p>
<p><code>awk &#39;!/^(--|[ \t]*$)/ {n++}</code><br><code>END {print n&quot; lines&quot;}&#39; *.lua</code><br>=&gt; 301 lines</p>
<p>Share and enjoy.</p>
<h2 id="coding-conventions">Coding conventions</h2>
<ul>
<li>Classes:<ul>
<li>Classes names in camel case, starting with an Upper case char. </li>
<li>Class methods are shown as Class.UPPERCASE (e.g. Module.NEW for constructors).</li>
<li>Instance methods are shown as Class.lowercase(i,…).</li>
<li>This code uses <code>i</code> and <code>j</code> and <code>k</code> for <code>self</code> and other instances.</li>
</ul>
</li>
<li>Type hints:<ul>
<li>Type hints are defined in terms of class names or  int,real, str,tab,bool.</li>
<li>?type denotes optional arguments.</li>
</ul>
</li>
<li>Formatting:<ul>
<li>Any line that just contains <code>end</code> is joined to the last line.</li>
<li>Where possible, write functions in one-line.</li>
<li>Line width max=80 (soft limit) or 83 (hard limit). </li>
<li>Tabs done with 2 spaces.</li>
</ul>
</li>
<li>Other:<ul>
<li>Common LUA routines imported from <code>lib.lua</code>.</li>
<li>Test suite at end (see <code>Go</code>).</li>
<li>Initial help string defines the config options.</li>
</ul>
</li>
<li>Command-line options<ul>
<li>If called as a main program, then <code>--xxxx value</code> on the command line updates option <code>xxxx</code>.</li>
<li>Shorthand #1: <code>-x</code>  is the same as  <code>--xxxx</code>.</li>
<li>Shorthand #2: Boolean <code>option</code>s don’t use <code>value</code>.
Merely mentioning it on the command-line will flip its default.</li>
</ul>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">local</span> help=<span class="hljs-string">[[

]]</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-2">&#x00a7;</a>
              </div>
              <hr>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-3">&#x00a7;</a>
              </div>
              <h2 id="names">Names</h2>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-4">&#x00a7;</a>
              </div>
              <p><code>the</code> stores settings for this code. <p>As to the classes used by this system:</p>
<ul>
<li><code>Row</code> hold the <code>cells</code> or record and a pointer (<code>of</code>) back to the 
container that made them.</li>
<li><code>Col</code> summarizes columns. One <code>Col</code> can be for
numerics or symbolic columns (denoted with <code> aCol.nums</code>).</li>
<li><code>Data</code> holds many <code>Row</code>s, summarized in a table <code>aData.cols</code>
(where <code>aData.cols.x</code> holds independent columns and
 <code>aData.cols.y</code> holds dependent columns). </li>
<li><code>Bin</code> is a helper class that summarizes what dependent <code>ys</code> values are
found between <code>lo</code> and <code>hi</code> of an independent column.</li>
<li><code>NB</code> is an application class that implements a Naive Bayes classifier.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">local</span> b4={}; <span class="hljs-keyword">for</span> x,_ <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(<span class="hljs-built_in">_ENV</span>) <span class="hljs-keyword">do</span> b4[x]=x <span class="hljs-keyword">end</span> 
<span class="hljs-keyword">local</span> _    = <span class="hljs-built_in">require</span><span class="hljs-string">&quot;lib&quot;</span>
<span class="hljs-keyword">local</span> Abcd = <span class="hljs-built_in">require</span><span class="hljs-string">&quot;abcd&quot;</span>

<span class="hljs-keyword">local</span> argmax,atom,big,csv,fmt = _.argmax, _.atom, _.big, _.csv, _.fmt
<span class="hljs-keyword">local</span> lt,map,o,oo,per,push    = _.lt, _.map, _.o, _.oo, _.per, _.push
<span class="hljs-keyword">local</span> R,<span class="hljs-built_in">sort</span>,splice,sum       = _.R,_ .<span class="hljs-built_in">sort</span>, _.splice, _.sum

<span class="hljs-keyword">local</span> the={ Min  = <span class="hljs-number">.5</span>,
            bins = <span class="hljs-number">16</span>,
            some = <span class="hljs-number">256</span>, 
            seed = <span class="hljs-number">10019</span>,
            wait = <span class="hljs-number">10</span>,
            m    = <span class="hljs-number">2</span>,
            k    = <span class="hljs-number">1</span>,
            file = <span class="hljs-string">&quot;../../../data/auto93.csv&quot;</span>}

<span class="hljs-keyword">local</span> Col,Data,Row,Bin,NB = {},{},{},{},{}</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-5">&#x00a7;</a>
              </div>
              <hr>

            </div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-6">&#x00a7;</a>
              </div>
              <h2 id="class-col">class Col</h2>
<p>Summaries a column of data. Uses different types for numeric or other data.</p>

            </div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-7">&#x00a7;</a>
              </div>
              <p><strong>.NEW( <code>at</code>:  ?int,  <code>txt</code>:  ?str) :Col</strong> <br> constructor of columns.
<code>.ok</code> is set to false after every update then set back
to true if ever we update the columns (see <code>Col.ok</code>).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.NEW</span><span class="hljs-params">(at,txt)</span></span>
  <span class="hljs-keyword">return</span> {n  =<span class="hljs-number">0</span>,     at=at <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>, txt=txt <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&quot;</span>, 
          ok =<span class="hljs-literal">false</span>, kept={},
          div=<span class="hljs-number">0</span>,     mid=<span class="hljs-number">0</span>} <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-8">&#x00a7;</a>
              </div>
              <p><strong>.NUM( <code>at</code>:  ?int,  <code>txt</code>:  ?str) :Col</strong> <br> constructor, specialized for numerics.
Numbers have a weight (-1,1) as well as the manddate to keep 
no more than  <code>aNum.nums</code> samples.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.NUM</span><span class="hljs-params">(at,txt,some,   i)</span></span>
   i     = Col.NEW(at,txt) <span class="hljs-comment">-- numerics are an extension to general columns.</span>
   i.w   = Col.WEIGHT(txt)
   i.nums= some <span class="hljs-keyword">or</span> the.some <span class="hljs-comment">-- if non-nil the i.nums is a numeric</span>
   <span class="hljs-keyword">return</span> i <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-9">&#x00a7;</a>
              </div>
              <h3 id="factory-to-make-cols">Factory to make Cols</h3>

            </div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-10">&#x00a7;</a>
              </div>
              <p><strong>.GOAL( <code>x</code>:  [str]) :bool</strong> <br> 
<strong>.NUMP( <code>x</code>:  [str]) :bool</strong> <br> 
<strong>.KLASS( <code>x</code>:  [str]) :bool</strong> <br> 
<strong>.SKIP( <code>x</code>:  [str]) :bool</strong> <br> recognize different column types</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.GOAL</span><span class="hljs-params">(x)</span></span>   <span class="hljs-keyword">return</span> (x <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&quot;</span>):<span class="hljs-built_in">find</span><span class="hljs-string">&quot;[!+-]$&quot;</span> <span class="hljs-keyword">end</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.NUMP</span><span class="hljs-params">(x)</span></span>   <span class="hljs-keyword">return</span> (x <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&quot;</span>):<span class="hljs-built_in">find</span><span class="hljs-string">&quot;^[A-Z]&quot;</span> <span class="hljs-keyword">end</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.KLASS</span><span class="hljs-params">(x)</span></span>  <span class="hljs-keyword">return</span> (x <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&quot;</span>):<span class="hljs-built_in">find</span><span class="hljs-string">&quot;!$&quot;</span>  <span class="hljs-keyword">end</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.SKIP</span><span class="hljs-params">(x)</span></span>   <span class="hljs-keyword">return</span> (x <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&quot;</span>):<span class="hljs-built_in">find</span><span class="hljs-string">&quot;:$&quot;</span>  <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-11">&#x00a7;</a>
              </div>
              <p><strong>.WEIGHT( <code>x</code>:  [str]) :(-1|1)</strong> <br> assign column weight.e.g. “-1” means “minimize”,</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.WEIGHT</span><span class="hljs-params">(x)</span></span> <span class="hljs-keyword">return</span> (x <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&quot;</span>):<span class="hljs-built_in">find</span><span class="hljs-string">&quot;-$&quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-number">-1</span> <span class="hljs-keyword">or</span> <span class="hljs-number">1</span> <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-12">&#x00a7;</a>
              </div>
              <p><strong>.COLS( <code>names</code>:  [str]) :tab</strong> <br> constructor (builds <code>Col</code>s from list of <code>names</code>).
Returns a table that stores dependents in <code>.y</code>, independents in <code>.x</code>, 
the klass (if it exists)in <code>.klass</code>. Caveat: 
only if we are not <code>.SKIP()</code>ping them.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.COLS</span><span class="hljs-params">(names)</span></span>
  <span class="hljs-keyword">local</span> i={x={}, y={}, names=names, klass=<span class="hljs-literal">nil</span>}
  <span class="hljs-keyword">for</span> at,txt <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(names) <span class="hljs-keyword">do</span>
    <span class="hljs-keyword">local</span> new = Col.NUMP(txt) <span class="hljs-keyword">and</span> Col.NUM(at,txt) <span class="hljs-keyword">or</span> Col.NEW(at,txt)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> Col.SKIP(txt) <span class="hljs-keyword">then</span>
      push(Col.GOAL(txt) <span class="hljs-keyword">and</span> i.y <span class="hljs-keyword">or</span> i.x, new)
      <span class="hljs-keyword">if</span> Col.KLASS(txt) <span class="hljs-keyword">then</span> i.klass=new <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">return</span> i <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-13">&#x00a7;</a>
              </div>
              <h3 id="update">Update</h3>

            </div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-14">&#x00a7;</a>
              </div>
              <p><strong>.add( <code>i</code>:  Col,  <code>v</code>:  any,  <code>inc</code>:  ?int) :Col</strong> <br> update <code>i</code> with  <code>v </code> ( inc  times)
Numeric columns keep a sample of the numbers while other columns track the
frequency of symbols seen so far.  The larger the sample, the less often
we update the numerics.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.add</span><span class="hljs-params">(i,v,inc)</span></span>
 inc = inc <span class="hljs-keyword">or</span> <span class="hljs-number">1</span>
 <span class="hljs-keyword">if</span>   v ~= <span class="hljs-string">&quot;?&quot;</span>
 <span class="hljs-keyword">then</span> i.n = i.n + inc
      <span class="hljs-keyword">if</span> i.nums 
      <span class="hljs-keyword">then</span> <span class="hljs-keyword">for</span> __=<span class="hljs-number">1</span>,inc <span class="hljs-keyword">do</span>
            <span class="hljs-keyword">if</span>     #i.kept &lt; i.nums <span class="hljs-keyword">then</span> i.ok=<span class="hljs-literal">false</span>;push(i.kept,v) 
            <span class="hljs-keyword">elseif</span> R() &lt; i.nums/i.n <span class="hljs-keyword">then</span> i.ok=<span class="hljs-literal">false</span>;i.kept[R(#i.kept)]=v <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span> 
      <span class="hljs-keyword">else</span> i.ok = <span class="hljs-literal">false</span>
           i.kept[v] = inc + (i.kept[v] <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>) <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">return</span> i <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-15">&#x00a7;</a>
              </div>
              <h3 id="computing-derived-properties">Computing derived properties</h3>

            </div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-16">&#x00a7;</a>
              </div>
              <p><strong>.ok( <code>i</code>:  Col)</strong> <br> ensure that the current contents are up to date. Returns <code>kept</code>.
E.g. update <code>mid</code>dle and <code>div</code>ersity (<em>median</em> and <em>standard
deviation</em> for numerics; and <em>mode</em> and <em>entropy</em> for others).<p>
This code uses the idiom “(per(.9) - per(.1))/2.56” to find
standard deviation. To grok that,
recall that &pm;1 and &pm;2
standard deviations marks out 66 to  95% of the mass. Somewhere in
between (at &pm;1.28), we get to 90% of the mass.  So to find one
standard deviation, divide the 90th minus 10th percentile by twice 1.28 (2.56).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.ok</span><span class="hljs-params">(i)</span></span>
  <span class="hljs-keyword">if</span>   <span class="hljs-keyword">not</span> i.ok 
  <span class="hljs-keyword">then</span> i.div, i.mid = <span class="hljs-number">0</span>, <span class="hljs-number">0</span>
       <span class="hljs-keyword">if</span>   i.nums 
       <span class="hljs-keyword">then</span> i.kept = <span class="hljs-built_in">sort</span>(i.kept) <span class="hljs-comment">-- very fast since &quot;kept&quot; is small</span>
            i.mid  = per(i.kept, <span class="hljs-number">.5</span>) <span class="hljs-comment">-- median</span>
            i.div  = (per(i.kept, <span class="hljs-number">.9</span>) - per(i.kept, <span class="hljs-number">.1</span>)) / <span class="hljs-number">2.56</span> <span class="hljs-comment">-- stdev</span>
       <span class="hljs-keyword">else</span> <span class="hljs-keyword">local</span> most = <span class="hljs-number">-1</span> <span class="hljs-comment">-- find the mode and ent</span>
            <span class="hljs-keyword">for</span> x,n <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(i.kept) <span class="hljs-keyword">do</span> 
              <span class="hljs-keyword">if</span> n &gt; most <span class="hljs-keyword">then</span> most, i.mid = n, x <span class="hljs-keyword">end</span>
              <span class="hljs-keyword">if</span> n &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">then</span> i.div=i.div - n/i.n*<span class="hljs-built_in">math</span>.<span class="hljs-built_in">log</span>(n/i.n,<span class="hljs-number">2</span>) <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span> 
  i.ok = <span class="hljs-literal">true</span> 
  <span class="hljs-keyword">return</span> i.kept <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-17">&#x00a7;</a>
              </div>
              <h3 id="querying">Querying</h3>
<p>Most of these need to call <code>Col.ok()</code> first (to ensure column is up to date).</p>

            </div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-18">&#x00a7;</a>
              </div>
              <p><strong>.lo( <code>i</code>:  Col) :num</strong> <br> 
<strong>.hi( <code>i</code>:  Col) :num</strong> <br> 
<strong>.div( <code>i</code>:  Col) :num</strong> <br> 
<strong>.mid( <code>i</code>:  Col) :any</strong> <br> <code>lo</code>west number, <code>hi</code>ghest number, <code>div</code>ersity, <code>mid</code>dle number. </p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.lo</span><span class="hljs-params">(i)</span></span>   Col.ok(i); <span class="hljs-keyword">return</span> i.kept[<span class="hljs-number">1</span>] <span class="hljs-keyword">end</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.hi</span><span class="hljs-params">(i)</span></span>   Col.ok(i); <span class="hljs-keyword">return</span> i.kept[#i.kept] <span class="hljs-keyword">end</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.div</span><span class="hljs-params">(i)</span></span>  Col.ok(i); <span class="hljs-keyword">return</span> i.div <span class="hljs-keyword">end</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.mid</span><span class="hljs-params">(i)</span></span>  Col.ok(i); <span class="hljs-keyword">return</span> i.mid <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-19">&#x00a7;</a>
              </div>
              <p><strong>.norm( <code>i</code>:  Col, <code>x</code>:  num) :0..1</strong> <br> normalize <code>x</code> 0..1 for lo..hi.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.norm</span><span class="hljs-params">(i,x)</span></span> 
  <span class="hljs-keyword">local</span> a=Col.ok(i); <span class="hljs-keyword">return</span> a[#a]-a[<span class="hljs-number">1</span>] &lt; <span class="hljs-number">1E-9</span> <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> (x-a[<span class="hljs-number">1</span>])/(a[#a]-a[<span class="hljs-number">1</span>]) <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-20">&#x00a7;</a>
              </div>
              <ul>
<li><h3 id="for-discretization">For Discretization</h3>
</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-21">&#x00a7;</a>
              </div>
              <p><strong>.bin( <code>i</code>:  Col, <code>x</code>:  any) :any</strong> <br> round numeric <code>x</code> to nearest <code>(hi-lo)/the.bins</code>
(and for non-numerics, just return <code>x</code>).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.bin</span><span class="hljs-params">(i,x)</span></span>
  <span class="hljs-keyword">if</span>   i.nums <span class="hljs-keyword">then</span>
    <span class="hljs-keyword">local</span> lo,hi = Col.lo(i), Col.hi(i)
    <span class="hljs-keyword">local</span> b=(hi - lo)/the.bins
    x = lo==hi <span class="hljs-keyword">and</span> <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">math</span>.<span class="hljs-built_in">floor</span>(x/b+<span class="hljs-number">.5</span>)*b <span class="hljs-keyword">end</span> 
  <span class="hljs-keyword">return</span> x <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-22">&#x00a7;</a>
              </div>
              <p><strong>.bin( <code>i</code>:  Col, <code>j</code>:  Col) :Col</strong> <br> returns a combination of two columns.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.merge</span><span class="hljs-params">(i,j,     k)</span></span>
  k = (i.nums <span class="hljs-keyword">and</span> Col.NUM <span class="hljs-keyword">or</span> Col.NEW)(i.at, i.txt)
  <span class="hljs-keyword">for</span> _,kept <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>{i.kept, j.kept} <span class="hljs-keyword">do</span>
    <span class="hljs-keyword">for</span> v,inc <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(kept) <span class="hljs-keyword">do</span> Col.add(k,v,inc) <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">return</span> k <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-23">&#x00a7;</a>
              </div>
              <p><strong>.simpler( <code>i</code>:  col, <code>this</code>:  col, <code>that</code>:  col):bool</strong> <br> am <code>i</code> simpler than <code>this</code> and <code>that</code>?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.simpler</span><span class="hljs-params">(i,this,that)</span></span>
  <span class="hljs-keyword">return</span> Col.div(i) &lt;= (this.n*Col.div(this) + that.n*Col.div(that)) / i.n <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-24">&#x00a7;</a>
              </div>
              <ul>
<li><h3 id="for-naive-bayes">For Naive Bayes</h3>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Col.like</span><span class="hljs-params">(i,x,prior)</span></span>
  <span class="hljs-keyword">if</span>   i.nums 
  <span class="hljs-keyword">then</span> <span class="hljs-keyword">local</span> sd,mu=Col.div(i), Col.mid(i)
       <span class="hljs-keyword">return</span> sd==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> (x==mu <span class="hljs-keyword">and</span> <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>) <span class="hljs-keyword">or</span>
           <span class="hljs-built_in">math</span>.<span class="hljs-built_in">exp</span>(<span class="hljs-number">-1</span>*(x - mu)^<span class="hljs-number">2</span>/(<span class="hljs-number">2</span>*sd^<span class="hljs-number">2</span>)) / (sd*((<span class="hljs-number">2</span>*<span class="hljs-built_in">math</span>.<span class="hljs-built_in">pi</span>)^<span class="hljs-number">0.5</span>)) 
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> ((i.kept[x] <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)+the.m*prior)/(i.n+the.m) <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-25">&#x00a7;</a>
              </div>
              <hr>

            </div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-26">&#x00a7;</a>
              </div>
              <h2 id="row">Row</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Row.NEW</span><span class="hljs-params">(of,cells)</span></span> <span class="hljs-keyword">return</span> {of=of,cells=cells,evaled=<span class="hljs-literal">false</span>} <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Row.better</span><span class="hljs-params">(i,j)</span></span>
  <span class="hljs-keyword">local</span> s1, s2, ys = <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, i.of.cols.y
  <span class="hljs-keyword">for</span> _,c <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(ys) <span class="hljs-keyword">do</span>
    <span class="hljs-keyword">local</span> x,y =  i.cells[c.at], j.cells[c.at]
    x,y = Col.norm(c, x), Col.norm(c, y)
    s1  = s1 - <span class="hljs-number">2.7183</span>^(c.w * (x-y)/#ys)
    s2  = s2 - <span class="hljs-number">2.7183</span>^(c.w * (y-x)/#ys) <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">return</span> s1/#ys &lt; s2/#ys  <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Row.klass</span><span class="hljs-params">(i)</span></span> <span class="hljs-keyword">return</span> i.cells[i.of.cols.klass.at] <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-27">&#x00a7;</a>
              </div>
              <hr>

            </div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-28">&#x00a7;</a>
              </div>
              <h2 id="data">Data</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Data.NEW</span><span class="hljs-params">(t)</span></span> <span class="hljs-keyword">return</span> {rows={}, cols=Col.COLS(t)} <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Data.ROWS</span><span class="hljs-params">(src,fun)</span></span>
  <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(src)==<span class="hljs-string">&quot;table&quot;</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">for</span>  _,t <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(src) <span class="hljs-keyword">do</span> fun(t) <span class="hljs-keyword">end</span>
                        <span class="hljs-keyword">else</span> <span class="hljs-keyword">for</span>    t <span class="hljs-keyword">in</span> csv(src)   <span class="hljs-keyword">do</span> fun(t) <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span> 

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Data.LOAD</span><span class="hljs-params">(src,    i)</span></span>
  Data.ROWS(src,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(t)</span></span> 
    <span class="hljs-keyword">if</span> i <span class="hljs-keyword">then</span> Data.add(i,t) <span class="hljs-keyword">else</span> i=Data.NEW(t) <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span>); <span class="hljs-keyword">return</span> i <span class="hljs-keyword">end</span>
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Data.clone</span><span class="hljs-params">(i,inits)</span></span>
  <span class="hljs-keyword">local</span> j=Data.NEW(i.cols.names)
  <span class="hljs-keyword">for</span> _,t <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(inits <span class="hljs-keyword">or</span> {}) <span class="hljs-keyword">do</span> Data.add(j,t) <span class="hljs-keyword">end</span>; <span class="hljs-keyword">return</span> j <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Data.add</span><span class="hljs-params">(i,t)</span></span>
  t = t.cells <span class="hljs-keyword">and</span> t <span class="hljs-keyword">or</span> Row.NEW(i,t)
  push(i.rows, t)
  <span class="hljs-keyword">for</span> _,cols <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>{i.cols.x, i.cols.y} <span class="hljs-keyword">do</span>
    <span class="hljs-keyword">for</span> _,c <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(cols) <span class="hljs-keyword">do</span> Col.add(c, t.cells[c.at]) <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span> 
  <span class="hljs-keyword">return</span> t <span class="hljs-keyword">end</span> 

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Data.mids</span><span class="hljs-params">(i,cols)</span></span> 
  <span class="hljs-keyword">local</span> t={}
  <span class="hljs-keyword">for</span> _,c <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(cols <span class="hljs-keyword">or</span> i.cols.y) <span class="hljs-keyword">do</span> t[c.txt] = Col.mid(c) <span class="hljs-keyword">end</span>;<span class="hljs-keyword">return</span> t <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Data.like</span><span class="hljs-params">(i,row, nklasses, nrows)</span></span>
  <span class="hljs-keyword">local</span> prior,like,inc,x
  prior = (#i.rows + the.k) / (nrows + the.k * nklasses)
  like  = <span class="hljs-built_in">math</span>.<span class="hljs-built_in">log</span>(prior)
  <span class="hljs-keyword">for</span> _,col <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(i.cols.x) <span class="hljs-keyword">do</span>
    x = row.cells[col.at] 
    <span class="hljs-keyword">if</span> x <span class="hljs-keyword">and</span> x ~= <span class="hljs-string">&quot;?&quot;</span> <span class="hljs-keyword">then</span>
      inc  = Col.like(col,x,prior)
      like = like + <span class="hljs-built_in">math</span>.<span class="hljs-built_in">log</span>(inc) <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">return</span> like <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-29">&#x00a7;</a>
              </div>
              <hr>

            </div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-30">&#x00a7;</a>
              </div>
              <h2 id="nb">NB</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">NB.NEW</span><span class="hljs-params">(src,report)</span></span>
  <span class="hljs-keyword">local</span> i  = {overall=<span class="hljs-literal">nil</span>, dict={}, list={}}
  report = report <span class="hljs-keyword">or</span> <span class="hljs-built_in">print</span>
  Data.ROWS(src, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(row)</span></span> 
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> i.overall <span class="hljs-keyword">then</span> i.overall = Data.NEW(row)  <span class="hljs-keyword">else</span> <span class="hljs-comment">-- (0) eat row1</span>
      row = Data.add(i.overall, row)  <span class="hljs-comment">-- XX add to overall </span>
      <span class="hljs-keyword">if</span> #i.overall.rows &gt; the.wait <span class="hljs-keyword">then</span> report(Row.klass(row), NB.guess(i,row)) <span class="hljs-keyword">end</span>
      NB.train(i,row) <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span>)              <span class="hljs-comment">-- add tp rows&#x27;s klass</span>
  <span class="hljs-keyword">return</span> i <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">NB.train</span><span class="hljs-params">(i,row)</span></span> 
  <span class="hljs-keyword">local</span> kl = Row.klass(row)
  i.dict[kl] = i.dict[kl] <span class="hljs-keyword">or</span> push(i.list, Data.clone(i.overall)) <span class="hljs-comment">-- klass is known</span>
  i.dict[kl].txt = kl                            <span class="hljs-comment">-- each klass knows its name</span>
  Data.add(i.dict[kl],row) <span class="hljs-keyword">end</span>                  <span class="hljs-comment">-- update klass with row</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">NB.guess</span><span class="hljs-params">(i,row)</span></span> 
  <span class="hljs-keyword">return</span> argmax(i.dict, 
    <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(klass)</span></span> <span class="hljs-keyword">return</span> Data.like(klass,row,#i.list,#i.overall.rows) <span class="hljs-keyword">end</span>) <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-31">&#x00a7;</a>
              </div>
              <hr>

            </div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-32">&#x00a7;</a>
              </div>
              <h2 id="bin">Bin</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Bin.NEW</span><span class="hljs-params">(xlo, xhi, ys)</span></span> <span class="hljs-keyword">return</span> {lo=xlo, hi=xhi, ys=ys} <span class="hljs-keyword">end</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Bin.add</span><span class="hljs-params">(i,x,y)</span></span>
  i.lo = <span class="hljs-built_in">math</span>.<span class="hljs-built_in">min</span>(i.lo, x)
  i.hi = <span class="hljs-built_in">math</span>.<span class="hljs-built_in">max</span>(i.hi, x)
  Col.add(i.ys, y) <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Bin.merge</span><span class="hljs-params">(i,j, min)</span></span>
  <span class="hljs-keyword">local</span> k = Col.merge(i,j)
  <span class="hljs-keyword">if</span> i.n &lt; <span class="hljs-built_in">min</span> <span class="hljs-keyword">or</span> j.n&lt;<span class="hljs-built_in">min</span> <span class="hljs-keyword">or</span> Col.simpler(k,i,j)  <span class="hljs-keyword">then</span> <span class="hljs-keyword">return</span> k <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Bin.BINS</span><span class="hljs-params">(listOfRows,col,y)</span></span>
  <span class="hljs-keyword">local</span> n,list, dict = <span class="hljs-number">0</span>,{}, {}
  <span class="hljs-keyword">for</span> label,rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(listOfRows) <span class="hljs-keyword">do</span>
    <span class="hljs-keyword">for</span> _,row <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(rows) <span class="hljs-keyword">do</span>
      <span class="hljs-keyword">local</span> v = row[col.at]
      <span class="hljs-keyword">if</span> v ~= <span class="hljs-string">&quot;?&quot;</span> <span class="hljs-keyword">then</span>
        n = n + <span class="hljs-number">1</span>
        <span class="hljs-keyword">local</span> pos = Col.bin(col,v)
        dict[pos] = dict[pos] <span class="hljs-keyword">or</span> push(list, Bin.new(v,v,Col.new(col.at,col.txt)))
        Bin.add(dict[pos], v, label) <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span>
    list = <span class="hljs-built_in">sort</span>(list, lt<span class="hljs-string">&quot;lo&quot;</span>)
    list = col.nums <span class="hljs-keyword">and</span> Bin.MERGES(list, n^the.<span class="hljs-built_in">min</span>) <span class="hljs-keyword">or</span> list
    <span class="hljs-keyword">return</span> {bins= list,
            div = sum(list,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(z)</span></span> <span class="hljs-keyword">return</span> Col.div(z.ys)*z.ys.n/n <span class="hljs-keyword">end</span>)} <span class="hljs-keyword">end</span>
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Bin.MERGES</span><span class="hljs-params">(b4, min)</span></span>
  <span class="hljs-keyword">local</span> n,now = <span class="hljs-number">1</span>,{}
  <span class="hljs-keyword">while</span> n &lt;= #b4 <span class="hljs-keyword">do</span> 
    <span class="hljs-keyword">local</span> merged = n&lt;#b4 <span class="hljs-keyword">and</span> Bin.merge(b4[n], b4[n+<span class="hljs-number">1</span>], <span class="hljs-built_in">min</span>)
    now[#now+<span class="hljs-number">1</span>]  = merged <span class="hljs-keyword">or</span> b4[n] 
    n            = n + (merged <span class="hljs-keyword">and</span> <span class="hljs-number">2</span> <span class="hljs-keyword">or</span> <span class="hljs-number">1</span>)  <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">if</span>   #now &lt; #b4 
  <span class="hljs-keyword">then</span> <span class="hljs-keyword">return</span> Bin.MERGES(now,<span class="hljs-built_in">min</span>) <span class="hljs-comment">-- loop to look for other merges</span>
  <span class="hljs-keyword">else</span> <span class="hljs-comment">-- stretch the bins to cover any gaps from minus infinity to plus infinity</span>
       <span class="hljs-keyword">for</span> n=<span class="hljs-number">2</span>,#now <span class="hljs-keyword">do</span> now[n].lo = now[n<span class="hljs-number">-1</span>].hi <span class="hljs-keyword">end</span>
       now[<span class="hljs-number">1</span>].lo, now[#now].hi = -big, big
       <span class="hljs-keyword">return</span> now <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-33">&#x00a7;</a>
              </div>
              <hr>

            </div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-34">&#x00a7;</a>
              </div>
              <p>To disable a test, relabel it from <code>Go</code> to <code>No</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">local</span> Go,No = {},{}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Go.THE</span><span class="hljs-params">()</span></span> oo(the) <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Go.ROWS</span><span class="hljs-params">(  d)</span></span> 
  Data.ROWS(the.file,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(row)</span></span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> d <span class="hljs-keyword">then</span> d=Data.NEW(row) <span class="hljs-keyword">else</span>
       Data.add(d,row) <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span>)
  oo(Data.mids(d)) <span class="hljs-keyword">end</span> 

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Go.STATS</span><span class="hljs-params">()</span></span> 
  oo(Data.mids(Data.LOAD(the.file) )) <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Go.ORDER</span><span class="hljs-params">(  i,t,m,left,right)</span></span> 
  i= Data.LOAD(the.file)
  t= <span class="hljs-built_in">sort</span>(i.rows,Row.better)
  m= (#t)^<span class="hljs-number">.5</span>
  left = Data.clone(i,splice(t,<span class="hljs-number">1</span>,m))
  right= Data.clone(i,splice(i.rows,#t - m))
  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;all&quot;</span>,  o(Data.mids(i)))
  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;best&quot;</span>, o(Data.mids(left)))
  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;rest&quot;</span>, o(Data.mids(right))) <span class="hljs-keyword">end</span> 

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Go.DIABETES</span><span class="hljs-params">(f,  i,t,a)</span></span> 
  a = Abcd.NEW()
  NB.NEW(f <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;../../../data/diabetes.csv&quot;</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(x,y)</span></span> Abcd.add(a,x,y) <span class="hljs-keyword">end</span>) 
  Abcd.pretty(a,Abcd.report(a)) <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Go.SOYBEAN</span><span class="hljs-params">()</span></span>  Go.DIABETES(<span class="hljs-string">&quot;../../../data/soybean.csv&quot;</span>) <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-35">&#x00a7;</a>
              </div>
              <hr>

            </div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-36">&#x00a7;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-built_in">math</span>.<span class="hljs-built_in">randomseed</span>(the.seed)
<span class="hljs-keyword">if</span> <span class="hljs-built_in">arg</span>[<span class="hljs-number">1</span>]==<span class="hljs-string">&quot;-g&quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(Go[<span class="hljs-built_in">arg</span>[<span class="hljs-number">2</span>]])==<span class="hljs-string">&quot;function&quot;</span> <span class="hljs-keyword">then</span> Go[<span class="hljs-built_in">arg</span>[<span class="hljs-number">2</span>]]() <span class="hljs-keyword">end</span>
<span class="hljs-keyword">for</span> x,v <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(<span class="hljs-built_in">_ENV</span>) <span class="hljs-keyword">do</span>  <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> b4[x] <span class="hljs-keyword">then</span> <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;?&quot;</span>,x,<span class="hljs-built_in">type</span>(v)) <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
